<?php 
defined("BASEPATH") OR exit("No direct script access allowed");

class User{
/* --------PRIVATE--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- */
    /* ------PROPERTIES--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- */
    private $username;
    private $hashedPassword;
    private $email;
    private $permissions;
    /* ------OTHERS------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- */
    private function setHashedPassword($hashedPassword){
        $this->hashedPassword = $hashedPassword;
    }
/* --------PUBLIC---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- */
    /* ------GETTERS------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ */
    public function getUsername(){
        return $this->username;
    }
    
    
    public function getHashedPassword(){
        return $this->hashedPassword;
    }
    
    
    public function getEmail(){
        return $this->email;
    }
    
    
    public function getPermissions(){
        return $this->permissions;
    }
    
    public function getAsArray(){
        return array(
            "username" => $this->getUsername(),
            "password" => $this->getHashedPassword(),
            "email" => $this->getEmail(),
            "permissions" => $this->getPermissions()
        );
    }
    /* ------SETTERS------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ */
    public function setUsername($username){
        $this->username = $username;
    }
    
    
    public function setEmail($email){
        $this->email = $email;
    }
    
    
    public function setPermissions($permissions){
        $this->permissions = $permissions;
    }
    /* ------OTHERS------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- */
    public function hashAndSetPassword($password){
        $this->setHashedPassword(password_hash($password, PASSWORD_DEFAULT));
    }
    
    
    public function equalToHashedPassword($password){
        return password_verify($password, $this->getHashedPassword());
    }
    
    
    public function initializeAll($username, $password, $email, $permission){
        $this->setUsername($username);
        $this->hashAndSetPassword($password);
        $this->setEmail($email);
        $this->setPermissions($permission);
    }
    
    
    public function __construct($username, $password, $email, $permission = "guest"){
        $this->initializeAll($username, $password, $email, $permission);
    }
}
    
/* --------PRIVATE--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- */
    /* ------PROPERTIES--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- */
    /* ------OTHERS------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- */
/* --------PUBLIC---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- */
    /* ------GETTERS------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ */
    /* ------SETTERS------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ */
    /* ------OTHERS------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- */
